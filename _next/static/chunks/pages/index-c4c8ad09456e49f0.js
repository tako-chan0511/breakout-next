(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{3568:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>f});var n=t(7876),a=t(4232),l=t(6796),s=t.n(l);let u=e=>{let{disabled:r,paddleWidth:t,onPaddleWidthChange:a,ballColor:l,onBallColorChange:u,paddleColor:c,onPaddleColorChange:i,onStart:d}=e;return(0,n.jsxs)("div",{className:"".concat(s().panel," ").concat(r?s().disabled:""),children:[(0,n.jsxs)("label",{className:s().label,children:["パドル幅:",(0,n.jsx)("input",{type:"number",min:20,max:300,value:t,disabled:r,onChange:e=>a(Number(e.target.value))})]}),(0,n.jsxs)("label",{className:s().label,children:["ボールカラー:",(0,n.jsx)("input",{type:"color",value:l,disabled:r,onChange:e=>u(e.target.value)})]}),(0,n.jsxs)("label",{className:s().label,children:["パドルカラー:",(0,n.jsx)("input",{type:"color",value:c,disabled:r,onChange:e=>i(e.target.value)})]}),(0,n.jsx)("button",{className:s().button,onClick:d,disabled:r,children:r?"ゲーム中…":"ゲームスタート"})]})};var c=t(4736),i=t.n(c);let d=e=>{let{score:r,lives:t,level:a}=e;return(0,n.jsxs)("div",{className:i().hudContainer,children:[(0,n.jsxs)("div",{className:i().hudItem,children:[(0,n.jsx)("span",{className:i().label,children:"スコア:"}),(0,n.jsx)("span",{className:i().value,children:r})]}),(0,n.jsxs)("div",{className:i().hudItem,children:[(0,n.jsx)("span",{className:i().label,children:"残ボール数:"}),(0,n.jsx)("span",{className:i().value,children:t})]}),(0,n.jsxs)("div",{className:i().hudItem,children:[(0,n.jsx)("span",{className:i().label,children:"レベル:"}),(0,n.jsx)("span",{className:i().value,children:a})]})]})};var o=t(9889),h=t.n(o);let v=(0,a.forwardRef)((e,r)=>{let{paddleWidth:t,ballColor:l,paddleColor:s,brickColors:u,backgroundColor:c,enableMouse:i=!1,gameActive:d,onUpdateScore:o,onUpdateLives:v,onUpdateLevel:m,onLostBall:_,onGameOver:x}=e,f=(0,a.useRef)(null),p=(0,a.useRef)(240),b=(0,a.useRef)(300),j=(0,a.useRef)(2),g=(0,a.useRef)(-2),N=(0,a.useRef)((480-t)/2),C=(0,a.useRef)(3),E=(0,a.useRef)(!1),y=(0,a.useRef)(!1),w=(0,a.useRef)(0),k=(0,a.useRef)(1),S=(0,a.useRef)([]);return(0,a.useEffect)(()=>{S.current=[];for(let e=0;e<5;e++){S.current[e]=[];for(let r=0;r<3;r++)S.current[e][r]={x:0,y:0,status:1}}},[]),(0,a.useImperativeHandle)(r,()=>({resetBall(){p.current=240,b.current=300,j.current=2,g.current=-2,E.current=!1}})),(0,a.useEffect)(()=>{let e=f.current;if(!e)return;let r=e.getContext("2d");if(!r)return;p.current=240,b.current=300,j.current=2,g.current=-2,N.current=(480-t)/2,C.current=3,w.current=0,k.current=1,y.current=!1,E.current=!1,S.current.forEach(e=>e.forEach(e=>e.status=1)),o(0),v(3),m(1);let n={value:!1},a={value:!1},h=e=>{!d||y.current||E.current||("ArrowLeft"===e.key&&(n.value=!0),"ArrowRight"===e.key&&(a.value=!0))},R=e=>{"ArrowLeft"===e.key&&(n.value=!1),"ArrowRight"===e.key&&(a.value=!1)},P=null,L=e=>{!d||y.current||E.current||(P=e.touches[0].clientX)},M=r=>{if(!d||y.current||E.current||null===P)return;let n=r.touches[0].clientX,a=480/e.getBoundingClientRect().width,l=(n-P)*a;N.current=Math.max(0,Math.min(N.current+l,480-t)),P=n},G=()=>{P=null},O=()=>{r.fillStyle=c,r.fillRect(0,0,480,320)},F=()=>{S.current.forEach((e,t)=>e.forEach((e,n)=>{if(1!==e.status)return;let a=85*t+30,l=30*n+30;e.x=a,e.y=l,r.beginPath(),r.fillStyle=u[n%u.length],r.rect(a,l,75,20),r.fill(),r.closePath()}))},I=()=>{r.beginPath(),r.arc(p.current,b.current,10,0,2*Math.PI),r.fillStyle=l,r.fill(),r.closePath()},A=()=>{r.beginPath(),r.rect(N.current,310,t,10),r.fillStyle=s,r.fill(),r.closePath()},W=()=>{let e=0;S.current.forEach(r=>r.forEach(r=>{1===r.status&&(e++,p.current>r.x&&p.current<r.x+75&&b.current>r.y&&b.current<r.y+20&&(g.current=-g.current,r.status=0,w.current+=10,o(w.current)))})),0===e&&(k.current++,j.current*=1.2,g.current*=1.2,S.current.forEach(e=>e.forEach(e=>e.status=1)),m(k.current))};return window.addEventListener("keydown",h),window.addEventListener("keyup",R),i&&(e.addEventListener("touchstart",L,{passive:!1}),e.addEventListener("touchmove",M,{passive:!1}),e.addEventListener("touchend",G)),!function e(){O(),F(),A(),I(),d&&!y.current&&(n.value&&(N.current=Math.max(0,N.current-7)),a.value&&(N.current=Math.min(480-t,N.current+7)),W(),(p.current+j.current>470||p.current+j.current<10)&&(j.current=-j.current),b.current+g.current<10?g.current=-g.current:b.current+g.current>310&&(p.current>N.current&&p.current<N.current+t?g.current=-g.current:(C.current--,v(C.current),_(C.current),E.current=!0,0===C.current&&(y.current=!0,x({score:w.current,lives:C.current})))),p.current+=j.current,b.current+=g.current),requestAnimationFrame(e)}(),()=>{window.removeEventListener("keydown",h),window.removeEventListener("keyup",R),i&&(e.removeEventListener("touchstart",L),e.removeEventListener("touchmove",M),e.removeEventListener("touchend",G))}},[d,t]),(0,n.jsx)("div",{className:h().canvasWrapper,children:(0,n.jsx)("canvas",{ref:f,width:480,height:320,className:h().gameCanvas})})});v.displayName="GameCanvas";var m=t(6996),_=t.n(m);let x=e=>{let{show:r,lives:t,onRestart:a}=e;return r?(0,n.jsx)("div",{className:_().backdrop,children:(0,n.jsxs)("div",{className:_().modal,children:[(0,n.jsx)("h3",{className:_().title,children:"ボールを失いました"}),(0,n.jsxs)("p",{className:_().text,children:["残り ",(0,n.jsx)("span",{className:_().lives,children:t})," 個"]}),(0,n.jsx)("button",{className:_().button,onClick:a,children:"OK"})]})}):null},f=()=>{let[e,r]=(0,a.useState)(75),[t,l]=(0,a.useState)("#FF0000"),[s,c]=(0,a.useState)("#00FF00"),[i]=(0,a.useState)(["#F00","#0F0","#00F","#FF0"]),[o]=(0,a.useState)("#000000"),[h,m]=(0,a.useState)(!1),[_,f]=(0,a.useState)(0),[p,b]=(0,a.useState)(3),[j,g]=(0,a.useState)(1),[N,C]=(0,a.useState)(!1),[E,y]=(0,a.useState)(!1),w=(0,a.useRef)(null);return(0,n.jsxs)("div",{style:{textAlign:"center",padding:"1rem"},children:[(0,n.jsx)("h1",{children:"Next.js版 ブロック崩し"}),(0,n.jsx)(u,{disabled:h,paddleWidth:e,onPaddleWidthChange:r,ballColor:t,onBallColorChange:l,paddleColor:s,onPaddleColorChange:c,onStart:()=>{f(0),b(3),g(1),C(!1),y(!1),m(!0)}}),(0,n.jsx)(d,{score:_,lives:p,level:j}),(0,n.jsx)(v,{ref:w,paddleWidth:e,ballColor:t,paddleColor:s,brickColors:i,backgroundColor:o,enableMouse:!0,gameActive:h,onUpdateScore:f,onUpdateLives:b,onUpdateLevel:g,onLostBall:e=>{b(e),C(!0)},onGameOver:e=>{let{score:r,lives:t}=e;f(r),b(t),y(!0),m(!1)}}),(0,n.jsx)(x,{show:N,lives:p,onRestart:()=>{var e;C(!1),null==(e=w.current)||e.resetBall()}}),E&&(0,n.jsx)("div",{className:"game-over-popup",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,n.jsxs)("div",{style:{background:"#333",color:"#fff",padding:"2rem",borderRadius:"8px"},children:[(0,n.jsx)("h2",{children:"ゲームオーバー"}),(0,n.jsxs)("p",{children:["レベル: ",j]}),(0,n.jsxs)("p",{children:["得点: ",_]}),(0,n.jsx)("button",{onClick:()=>y(!1),style:{marginTop:"1rem",padding:"0.5rem 1rem"},children:"OK"})]})})]})}},4736:e=>{e.exports={hudContainer:"HUD_hudContainer__IxD_Y",hudItem:"HUD_hudItem__NLdqF",label:"HUD_label__otNDQ",value:"HUD_value__0_Y7i"}},6760:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(3568)}])},6796:e=>{e.exports={panel:"SettingsPanel_panel__ofYeo",disabled:"SettingsPanel_disabled__MEVeC",label:"SettingsPanel_label__VKXj_",button:"SettingsPanel_button__b7OXI"}},6996:e=>{e.exports={backdrop:"GameOverModal_backdrop__AKqPs",modal:"GameOverModal_modal__i83M3",title:"GameOverModal_title__Wrb_f",text:"GameOverModal_text__zcJWJ",lives:"GameOverModal_lives__SbGG3",button:"GameOverModal_button__qxWhP"}},9889:e=>{e.exports={canvasWrapper:"GameCanvas_canvasWrapper__ZsENA",gameCanvas:"GameCanvas_gameCanvas__fbuBx"}}},e=>{var r=r=>e(e.s=r);e.O(0,[636,593,792],()=>r(6760)),_N_E=e.O()}]);