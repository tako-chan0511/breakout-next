(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{3568:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>p});var n=t(7876),a=t(4232),l=t(6796),s=t.n(l);let c=e=>{let{disabled:r,paddleWidth:t,onPaddleWidthChange:a,ballColor:l,onBallColorChange:c,paddleColor:u,onPaddleColorChange:i,onStart:o}=e;return(0,n.jsxs)("div",{className:"".concat(s().panel," ").concat(r?s().disabled:""),children:[(0,n.jsxs)("label",{className:s().label,children:["パドル幅:",(0,n.jsx)("input",{type:"number",min:20,max:300,value:t,disabled:r,onChange:e=>a(Number(e.target.value))})]}),(0,n.jsxs)("label",{className:s().label,children:["ボールカラー:",(0,n.jsx)("input",{type:"color",value:l,disabled:r,onChange:e=>c(e.target.value)})]}),(0,n.jsxs)("label",{className:s().label,children:["パドルカラー:",(0,n.jsx)("input",{type:"color",value:u,disabled:r,onChange:e=>i(e.target.value)})]}),(0,n.jsx)("button",{className:s().button,onClick:o,disabled:r,children:r?"ゲーム中…":"ゲームスタート"})]})};var u=t(4736),i=t.n(u);let o=e=>{let{score:r,lives:t,level:a}=e;return(0,n.jsxs)("div",{className:i().hudContainer,children:[(0,n.jsxs)("div",{className:i().hudItem,children:[(0,n.jsx)("span",{className:i().label,children:"スコア:"}),(0,n.jsx)("span",{className:i().value,children:r})]}),(0,n.jsxs)("div",{className:i().hudItem,children:[(0,n.jsx)("span",{className:i().label,children:"残ボール数:"}),(0,n.jsx)("span",{className:i().value,children:t})]}),(0,n.jsxs)("div",{className:i().hudItem,children:[(0,n.jsx)("span",{className:i().label,children:"レベル:"}),(0,n.jsx)("span",{className:i().value,children:a})]})]})};var d=t(9889),h=t.n(d);let v=(0,a.forwardRef)((e,r)=>{let{paddleWidth:t,ballColor:l,paddleColor:s,brickColors:c,backgroundColor:u,enableMouse:i=!1,gameActive:o,onUpdateScore:d,onUpdateLives:v,onUpdateLevel:m,onLostBall:f,onGameOver:_}=e,p=(0,a.useRef)(null),x=(0,a.useRef)(240),b=(0,a.useRef)(300),g=(0,a.useRef)(2),j=(0,a.useRef)(-2),N=(0,a.useRef)((480-t)/2),C=(0,a.useRef)(3),y=(0,a.useRef)(!1),E=(0,a.useRef)(!1),w=(0,a.useRef)(0),S=(0,a.useRef)(1),k=(0,a.useRef)([]);(0,a.useEffect)(()=>{k.current=Array.from({length:5},()=>Array.from({length:3},()=>({x:0,y:0,status:1})))},[]),(0,a.useImperativeHandle)(r,()=>({resetBall(){x.current=240,b.current=300,g.current=2,j.current=-2,y.current=!1}}));let P=e=>{k.current.forEach((r,t)=>r.forEach((r,n)=>{if(1!==r.status)return;let a=85*t+30,l=30*n+30;r.x=a,r.y=l,e.beginPath(),e.fillStyle=c[n%c.length],e.rect(a,l,75,20),e.fill(),e.closePath()}))};return(0,a.useEffect)(()=>{let e=p.current;if(!e)return;let r=e.getContext("2d");r.fillStyle=u,r.fillRect(0,0,480,320),P(r),r.beginPath(),r.rect(N.current,310,t,10),r.fillStyle=s,r.fill(),r.closePath(),r.beginPath(),r.arc(x.current,b.current,10,0,2*Math.PI),r.fillStyle=l,r.fill(),r.closePath()},[u,c,s,t,l]),(0,a.useEffect)(()=>{let e=p.current;if(!e)return;let r=e.getContext("2d");if(!r||!o)return;x.current=240,b.current=300,g.current=2,j.current=-2,N.current=(480-t)/2,C.current=3,w.current=0,S.current=1,y.current=!1,E.current=!1,k.current.forEach(e=>e.forEach(e=>e.status=1)),d(0),v(3),m(1);let n={value:!1},a={value:!1},c=e=>{!o||E.current||y.current||("ArrowLeft"===e.key&&(n.value=!0),"ArrowRight"===e.key&&(a.value=!0))},h=e=>{"ArrowLeft"===e.key&&(n.value=!1),"ArrowRight"===e.key&&(a.value=!1)},R=null,L=e=>{!o||E.current||y.current||(R=e.touches[0].clientX)},A=r=>{if(!o||E.current||y.current||null===R)return;let n=r.touches[0].clientX,a=480/e.getBoundingClientRect().width,l=(n-R)*a;N.current=Math.max(0,Math.min(N.current+l,480-t)),R=n},M=()=>{R=null},G=()=>{let e=0;k.current.forEach(r=>r.forEach(r=>{1===r.status&&(e++,x.current>r.x&&x.current<r.x+75&&b.current>r.y&&b.current<r.y+20&&(j.current=-j.current,r.status=0,w.current+=10,d(w.current)))})),0===e&&(S.current++,g.current*=1.2,j.current*=1.2,k.current.forEach(e=>e.forEach(e=>e.status=1)),m(S.current))};return window.addEventListener("keydown",c),window.addEventListener("keyup",h),i&&(e.addEventListener("touchstart",L,{passive:!1}),e.addEventListener("touchmove",A,{passive:!1}),e.addEventListener("touchend",M)),!function e(){if(r.fillStyle=u,r.fillRect(0,0,480,320),P(r),r.beginPath(),r.rect(N.current,310,t,10),r.fillStyle=s,r.fill(),r.closePath(),r.beginPath(),r.arc(x.current,b.current,10,0,2*Math.PI),r.fillStyle=l,r.fill(),r.closePath(),o&&!E.current&&!y.current){if(n.value&&(N.current=Math.max(0,N.current-7)),a.value&&(N.current=Math.min(480-t,N.current+7)),G(),(x.current+g.current>470||x.current+g.current<10)&&(g.current=-g.current),b.current+j.current<10)j.current=-j.current;else if(b.current+j.current>310)if(x.current>N.current&&x.current<N.current+t)j.current=-j.current;else if(C.current--,v(C.current),C.current>0)y.current=!0,f(C.current);else{y.current=!0,E.current=!0,_({score:w.current,lives:C.current,level:S.current});return}x.current+=g.current,b.current+=j.current}E.current||requestAnimationFrame(e)}(),()=>{window.removeEventListener("keydown",c),window.removeEventListener("keyup",h),i&&(e.removeEventListener("touchstart",L),e.removeEventListener("touchmove",A),e.removeEventListener("touchend",M))}},[o,t,u,c,s,l]),(0,n.jsxs)("div",{className:h().canvasWrapper,children:[(0,n.jsx)("canvas",{ref:p,width:480,height:320,className:h().gameCanvas}),i&&(0,n.jsx)("div",{className:h().swipeArea})]})});v.displayName="GameCanvas";var m=t(6996),f=t.n(m);let _=e=>{let{show:r,lives:t,onRestart:a}=e;return r?(0,n.jsx)("div",{className:f().backdrop,children:(0,n.jsxs)("div",{className:f().modal,children:[(0,n.jsx)("h3",{className:f().title,children:"ボールを失いました"}),(0,n.jsxs)("p",{className:f().text,children:["残り ",(0,n.jsx)("span",{className:f().lives,children:t})," 個"]}),(0,n.jsx)("button",{className:f().button,onClick:a,children:"OK"})]})}):null},p=()=>{let[e,r]=(0,a.useState)(75),[t,l]=(0,a.useState)("#FF0000"),[s,u]=(0,a.useState)("#00FF00"),[i]=(0,a.useState)(["#F00","#0F0","#00F","#FF0"]),[d]=(0,a.useState)("#000000"),[h,m]=(0,a.useState)(!1),[f,p]=(0,a.useState)(0),[x,b]=(0,a.useState)(3),[g,j]=(0,a.useState)(1),[N,C]=(0,a.useState)(!1),[y,E]=(0,a.useState)(!1),w=(0,a.useRef)(null);return(0,n.jsxs)("div",{style:{textAlign:"center",padding:"1rem"},children:[(0,n.jsx)("h1",{children:"Next.js版 ブロック崩し"}),(0,n.jsx)(c,{disabled:h,paddleWidth:e,onPaddleWidthChange:r,ballColor:t,onBallColorChange:l,paddleColor:s,onPaddleColorChange:u,onStart:()=>{var e;p(0),b(3),j(1),C(!1),E(!1),m(!0),null==(e=w.current)||e.resetBall()}}),(0,n.jsx)(o,{score:f,lives:x,level:g}),(0,n.jsx)(v,{ref:w,paddleWidth:e,ballColor:t,paddleColor:s,brickColors:i,backgroundColor:d,enableMouse:!0,gameActive:h,onUpdateScore:p,onUpdateLives:b,onUpdateLevel:j,onLostBall:e=>{b(e),C(!0)},onGameOver:e=>{p(e.score),b(e.lives),"number"==typeof e.level&&j(e.level),E(!0),m(!1)}}),(0,n.jsx)(_,{show:N,lives:x,onRestart:()=>{var e;C(!1),null==(e=w.current)||e.resetBall()}}),y&&(0,n.jsx)("div",{className:"game-over-popup",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,n.jsxs)("div",{style:{background:"#333",color:"#fff",padding:"2rem",borderRadius:"8px",textAlign:"center"},children:[(0,n.jsx)("h2",{children:"ゲームオーバー"}),(0,n.jsxs)("p",{children:["レベル: ",g]}),(0,n.jsxs)("p",{children:["得点: ",f]}),(0,n.jsx)("button",{onClick:()=>E(!1),style:{marginTop:"1rem",padding:"0.5rem 1rem"},children:"OK"})]})})]})}},4736:e=>{e.exports={hudContainer:"HUD_hudContainer__IxD_Y",hudItem:"HUD_hudItem__NLdqF",label:"HUD_label__otNDQ",value:"HUD_value__0_Y7i"}},6760:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(3568)}])},6796:e=>{e.exports={panel:"SettingsPanel_panel__ofYeo",disabled:"SettingsPanel_disabled__MEVeC",label:"SettingsPanel_label__VKXj_",button:"SettingsPanel_button__b7OXI"}},6996:e=>{e.exports={backdrop:"GameOverModal_backdrop__AKqPs",modal:"GameOverModal_modal__i83M3",title:"GameOverModal_title__Wrb_f",text:"GameOverModal_text__zcJWJ",lives:"GameOverModal_lives__SbGG3",button:"GameOverModal_button__qxWhP"}},9889:e=>{e.exports={canvasWrapper:"GameCanvas_canvasWrapper__ZsENA",gameCanvas:"GameCanvas_gameCanvas__fbuBx",swipeArea:"GameCanvas_swipeArea__Y2ktE"}}},e=>{var r=r=>e(e.s=r);e.O(0,[636,593,792],()=>r(6760)),_N_E=e.O()}]);