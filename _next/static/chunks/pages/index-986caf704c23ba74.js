(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{3568:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>p});var n=t(7876),a=t(4232),l=t(6796),s=t.n(l);let u=e=>{let{disabled:r,paddleWidth:t,onPaddleWidthChange:a,ballColor:l,onBallColorChange:u,paddleColor:c,onPaddleColorChange:i,onStart:o}=e;return(0,n.jsxs)("div",{className:"".concat(s().panel," ").concat(r?s().disabled:""),children:[(0,n.jsxs)("label",{className:s().label,children:["パドル幅:",(0,n.jsx)("input",{type:"number",min:20,max:300,value:t,disabled:r,onChange:e=>a(Number(e.target.value))})]}),(0,n.jsxs)("label",{className:s().label,children:["ボールカラー:",(0,n.jsx)("input",{type:"color",value:l,disabled:r,onChange:e=>u(e.target.value)})]}),(0,n.jsxs)("label",{className:s().label,children:["パドルカラー:",(0,n.jsx)("input",{type:"color",value:c,disabled:r,onChange:e=>i(e.target.value)})]}),(0,n.jsx)("button",{className:s().button,onClick:o,disabled:r,children:r?"ゲーム中…":"ゲームスタート"})]})};var c=t(4736),i=t.n(c);let o=e=>{let{score:r,lives:t,level:a}=e;return(0,n.jsxs)("div",{className:i().hudContainer,children:[(0,n.jsxs)("div",{className:i().hudItem,children:[(0,n.jsx)("span",{className:i().label,children:"スコア:"}),(0,n.jsx)("span",{className:i().value,children:r})]}),(0,n.jsxs)("div",{className:i().hudItem,children:[(0,n.jsx)("span",{className:i().label,children:"残ボール数:"}),(0,n.jsx)("span",{className:i().value,children:t})]}),(0,n.jsxs)("div",{className:i().hudItem,children:[(0,n.jsx)("span",{className:i().label,children:"レベル:"}),(0,n.jsx)("span",{className:i().value,children:a})]})]})};var d=t(9889),h=t.n(d);let v=(0,a.forwardRef)((e,r)=>{let{paddleWidth:t,ballColor:l,paddleColor:s,brickColors:u,backgroundColor:c,enableMouse:i=!1,gameActive:o,onUpdateScore:d,onUpdateLives:v,onUpdateLevel:f,onLostBall:m,onGameOver:_}=e,p=(0,a.useRef)(null),x=(0,a.useRef)(240),b=(0,a.useRef)(300),g=(0,a.useRef)(2),j=(0,a.useRef)(-2),N=(0,a.useRef)((480-t)/2),C=(0,a.useRef)(3),E=(0,a.useRef)(!1),y=(0,a.useRef)(!1),w=(0,a.useRef)(0),S=(0,a.useRef)(1),k=(0,a.useRef)([]);return(0,a.useEffect)(()=>{k.current=[];for(let e=0;e<5;e++){k.current[e]=[];for(let r=0;r<3;r++)k.current[e][r]={x:0,y:0,status:1}}},[]),(0,a.useImperativeHandle)(r,()=>({resetBall(){x.current=240,b.current=300,g.current=2,j.current=-2,E.current=!1}})),(0,a.useEffect)(()=>{let e=p.current;if(!e)return;let r=e.getContext("2d");r.fillStyle=c,r.fillRect(0,0,480,320),k.current.forEach((e,t)=>e.forEach((e,n)=>{1===e.status&&(r.beginPath(),r.fillStyle=u[n%u.length],r.rect(85*t+30,30*n+30,75,20),r.fill(),r.closePath())}))},[]),(0,a.useEffect)(()=>{let e=p.current;if(!e)return;let r=e.getContext("2d");if(!r||!o)return;x.current=240,b.current=300,g.current=2,j.current=-2,N.current=(480-t)/2,C.current=3,w.current=0,S.current=1,E.current=!1,y.current=!1,k.current.forEach(e=>e.forEach(e=>e.status=1)),d(0),v(3),f(1);let n={value:!1},a={value:!1},h=e=>{!o||y.current||E.current||("ArrowLeft"===e.key&&(n.value=!0),"ArrowRight"===e.key&&(a.value=!0))},R=e=>{"ArrowLeft"===e.key&&(n.value=!1),"ArrowRight"===e.key&&(a.value=!1)},P=null,L=e=>{!o||y.current||E.current||(P=e.touches[0].clientX)},M=r=>{if(!o||y.current||E.current||null===P)return;let n=r.touches[0].clientX,a=480/e.getBoundingClientRect().width,l=(n-P)*a;N.current=Math.max(0,Math.min(N.current+l,480-t)),P=n},G=()=>{P=null},A=()=>{r.fillStyle=c,r.fillRect(0,0,480,320)},O=()=>{k.current.forEach((e,t)=>e.forEach((e,n)=>{if(1!==e.status)return;let a=85*t+30,l=30*n+30;e.x=a,e.y=l,r.beginPath(),r.fillStyle=u[n%u.length],r.rect(a,l,75,20),r.fill(),r.closePath()}))},F=()=>{r.beginPath(),r.arc(x.current,b.current,10,0,2*Math.PI),r.fillStyle=l,r.fill(),r.closePath()},I=()=>{r.beginPath(),r.rect(N.current,310,t,10),r.fillStyle=s,r.fill(),r.closePath()},W=()=>{let e=0;k.current.forEach(r=>r.forEach(r=>{1===r.status&&(e++,x.current>r.x&&x.current<r.x+75&&b.current>r.y&&b.current<r.y+20&&(j.current=-j.current,r.status=0,w.current+=10,d(w.current)))})),0===e&&(S.current++,g.current*=1.2,j.current*=1.2,k.current.forEach(e=>e.forEach(e=>e.status=1)),f(S.current))};return window.addEventListener("keydown",h),window.addEventListener("keyup",R),i&&(e.addEventListener("touchstart",L,{passive:!1}),e.addEventListener("touchmove",M,{passive:!1}),e.addEventListener("touchend",G)),!function e(){if(A(),O(),I(),F(),!o||y.current||E.current){if(y.current)return}else{if(n.value&&(N.current=Math.max(0,N.current-7)),a.value&&(N.current=Math.min(480-t,N.current+7)),W(),(x.current+g.current>470||x.current+g.current<10)&&(g.current=-g.current),b.current+j.current<10)j.current=-j.current;else if(b.current+j.current>310)if(x.current>N.current&&x.current<N.current+t)j.current=-j.current;else if(C.current--,v(C.current),C.current>0)E.current=!0,m(C.current);else{E.current=!0,y.current=!0,_({score:w.current,lives:C.current,level:S.current});return}x.current+=g.current,b.current+=j.current}y.current||requestAnimationFrame(e)}(),()=>{window.removeEventListener("keydown",h),window.removeEventListener("keyup",R),i&&(e.removeEventListener("touchstart",L),e.removeEventListener("touchmove",M),e.removeEventListener("touchend",G))}},[o,t]),(0,n.jsx)("div",{className:h().canvasWrapper,children:(0,n.jsx)("canvas",{ref:p,width:480,height:320,className:h().gameCanvas})})});v.displayName="GameCanvas";var f=t(6996),m=t.n(f);let _=e=>{let{show:r,lives:t,onRestart:a}=e;return r?(0,n.jsx)("div",{className:m().backdrop,children:(0,n.jsxs)("div",{className:m().modal,children:[(0,n.jsx)("h3",{className:m().title,children:"ボールを失いました"}),(0,n.jsxs)("p",{className:m().text,children:["残り ",(0,n.jsx)("span",{className:m().lives,children:t})," 個"]}),(0,n.jsx)("button",{className:m().button,onClick:a,children:"OK"})]})}):null},p=()=>{let[e,r]=(0,a.useState)(75),[t,l]=(0,a.useState)("#FF0000"),[s,c]=(0,a.useState)("#00FF00"),[i]=(0,a.useState)(["#F00","#0F0","#00F","#FF0"]),[d]=(0,a.useState)("#000000"),[h,f]=(0,a.useState)(!1),[m,p]=(0,a.useState)(0),[x,b]=(0,a.useState)(3),[g,j]=(0,a.useState)(1),[N,C]=(0,a.useState)(!1),[E,y]=(0,a.useState)(!1),w=(0,a.useRef)(null);return(0,n.jsxs)("div",{style:{textAlign:"center",padding:"1rem"},children:[(0,n.jsx)("h1",{children:"Next.js版 ブロック崩し"}),(0,n.jsx)(u,{disabled:h,paddleWidth:e,onPaddleWidthChange:r,ballColor:t,onBallColorChange:l,paddleColor:s,onPaddleColorChange:c,onStart:()=>{var e;p(0),b(3),j(1),C(!1),y(!1),f(!0),null==(e=w.current)||e.resetBall()}}),(0,n.jsx)(o,{score:m,lives:x,level:g}),(0,n.jsx)(v,{ref:w,paddleWidth:e,ballColor:t,paddleColor:s,brickColors:i,backgroundColor:d,enableMouse:!0,gameActive:h,onUpdateScore:p,onUpdateLives:b,onUpdateLevel:j,onLostBall:e=>{b(e),C(!0)},onGameOver:e=>{p(e.score),b(e.lives),"number"==typeof e.level&&j(e.level),y(!0),f(!1)}}),(0,n.jsx)(_,{show:N,lives:x,onRestart:()=>{var e;C(!1),null==(e=w.current)||e.resetBall()}}),E&&(0,n.jsx)("div",{className:"game-over-popup",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,n.jsxs)("div",{style:{background:"#333",color:"#fff",padding:"2rem",borderRadius:"8px",textAlign:"center"},children:[(0,n.jsx)("h2",{children:"ゲームオーバー"}),(0,n.jsxs)("p",{children:["レベル: ",g]}),(0,n.jsxs)("p",{children:["得点: ",m]}),(0,n.jsx)("button",{onClick:()=>y(!1),style:{marginTop:"1rem",padding:"0.5rem 1rem"},children:"OK"})]})})]})}},4736:e=>{e.exports={hudContainer:"HUD_hudContainer__IxD_Y",hudItem:"HUD_hudItem__NLdqF",label:"HUD_label__otNDQ",value:"HUD_value__0_Y7i"}},6760:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(3568)}])},6796:e=>{e.exports={panel:"SettingsPanel_panel__ofYeo",disabled:"SettingsPanel_disabled__MEVeC",label:"SettingsPanel_label__VKXj_",button:"SettingsPanel_button__b7OXI"}},6996:e=>{e.exports={backdrop:"GameOverModal_backdrop__AKqPs",modal:"GameOverModal_modal__i83M3",title:"GameOverModal_title__Wrb_f",text:"GameOverModal_text__zcJWJ",lives:"GameOverModal_lives__SbGG3",button:"GameOverModal_button__qxWhP"}},9889:e=>{e.exports={canvasWrapper:"GameCanvas_canvasWrapper__ZsENA",gameCanvas:"GameCanvas_gameCanvas__fbuBx",swipeArea:"GameCanvas_swipeArea__Y2ktE"}}},e=>{var r=r=>e(e.s=r);e.O(0,[636,593,792],()=>r(6760)),_N_E=e.O()}]);